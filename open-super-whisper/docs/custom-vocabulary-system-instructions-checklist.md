# カスタム語彙・システムプロンプト保存問題解決チェックリスト

## 修正前の確認

- [ ] カスタム語彙を設定しても保存されない
- [ ] システムプロンプトを設定しても保存されない
- [ ] アプリケーション再起動後に設定が消える
- [ ] 設定ファイルに `custom_vocabulary` や `system_instructions` が保存されていない

## 修正内容の確認

### コード修正の確認

- [ ] `src/gui/windows/main_window.py` に `import json` が追加されている
- [ ] `_save_vocabulary()` メソッドでJSON形式で保存するように修正されている
- [ ] `_save_system_instructions()` メソッドでJSON形式で保存するように修正されている
- [ ] `_load_saved_vocabulary()` メソッドでJSON形式から読み込むように修正されている
- [ ] `_load_saved_system_instructions()` メソッドでJSON形式から読み込むように修正されている

### デバッグ機能の確認

- [ ] 保存時にデバッグ情報が出力される
- [ ] 読み込み時にデバッグ情報が出力される
- [ ] エラー発生時にスタックトレースが出力される
- [ ] 保存確認のための即座の読み込みテストが実行される

## テスト手順

### 1. 基本動作テスト

- [ ] アプリケーションが正常に起動する
- [ ] カスタム語彙ダイアログが表示される
- [ ] システム指示ダイアログが表示される
- [ ] 語彙や指示を追加できる
- [ ] 語彙や指示を削除できる

### 2. 保存機能テスト

- [ ] カスタム語彙を追加してOKを押す
- [ ] システム指示を追加してOKを押す
- [ ] コンソールにデバッグ情報が出力される
- [ ] 設定ファイルにJSON形式で保存される

### 3. 読み込み機能テスト

- [ ] アプリケーションを再起動する
- [ ] 保存したカスタム語彙が読み込まれる
- [ ] 保存したシステム指示が読み込まれる
- [ ] コンソールに読み込みデバッグ情報が出力される

### 4. 設定ファイル確認

- [ ] 設定ファイルが存在する
- [ ] `custom_vocabulary` がJSON形式で保存されている
- [ ] `system_instructions` がJSON形式で保存されている
- [ ] 日本語文字が正しく保存されている

## 問題が解決しない場合の対処法

### 1. デバッグ情報の確認

- [ ] コンソール出力を確認する
- [ ] エラーメッセージを確認する
- [ ] スタックトレースを確認する

### 2. 設定ファイルの確認

```bash
# macOS
plutil -p ~/Library/Preferences/com.opensuperwhisper.OpenSuperWhisper.plist

# Windows
# レジストリエディタで確認

# Linux
# ~/.config/OpenSuperWhisper/OpenSuperWhisper.conf を確認
```

### 3. 手動での設定ファイル削除

```bash
# macOS
rm ~/Library/Preferences/com.opensuperwhisper.OpenSuperWhisper.plist

# Windows
# レジストリから削除

# Linux
rm ~/.config/OpenSuperWhisper/OpenSuperWhisper.conf
```

### 4. 追加のデバッグ情報

- [ ] より詳細なデバッグ情報を追加する
- [ ] 設定ファイルの読み書き権限を確認する
- [ ] ディスク容量を確認する

## 成功の確認

- [ ] カスタム語彙が正しく保存される
- [ ] システム指示が正しく保存される
- [ ] アプリケーション再起動後に設定が保持される
- [ ] 日本語文字が正しく保存・読み込みされる
- [ ] デバッグ情報が正常に出力される

## 今後の改善点

- [ ] 設定のバックアップ機能を追加
- [ ] 設定のインポート/エクスポート機能を追加
- [ ] 設定の検証機能を追加
- [ ] より詳細なエラーハンドリングを追加
- [ ] ユーザー向けの設定管理UIを追加 